"use strict";(()=>{var e={};e.id=107,e.ids=[107],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},507:(e,t,r)=>{r.r(t),r.d(t,{config:()=>d,default:()=>u,routeModule:()=>l});var s={};r.r(s),r.d(s,{default:()=>handler});var a=r(1802),i=r(7153),n=r(6249),o=r(6962);async function handler(e,t){let{id:r}=e.query;if("DELETE"===e.method){let s=e.headers.authorization;if(!s||!s.startsWith("Bearer "))return t.status(401).json({error:"not_authenticated"});let a=s.split(" ")[1],{data:i}=await o.R.auth.getUser(a),n=i?.user;if(!n)return t.status(401).json({error:"invalid_token"});let{data:u}=await o.R.from("comments").select("user_id").eq("id",r).limit(1),d=u?.[0]?.user_id;if(d!==n.id)return t.status(403).json({error:"forbidden"});let{error:l}=await o.R.from("comments").delete().eq("id",r);return l?t.status(500).json({error:"db_error"}):t.json({ok:!0})}return t.status(405).end()}let u=(0,n.l)(s,"default"),d=(0,n.l)(s,"config"),l=new a.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/comments/[id]",pathname:"/api/comments/[id]",bundlePath:"",filename:""},userland:s})},6962:(e,t,r)=>{r.d(t,{R:()=>i});let s=require("@supabase/supabase-js"),a=process.env.SUPABASE_SERVICE_ROLE_KEY,i=(0,s.createClient)("https://pgsvorcullkrgmcbpszb.supabase.co",a,{auth:{persistSession:!1}})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),r=t.X(0,[222],()=>__webpack_exec__(507));module.exports=r})();