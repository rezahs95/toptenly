"use strict";(()=>{var e={};e.id=228,e.ids=[228],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6144:(e,t,i)=>{i.r(t),i.d(t,{config:()=>o,default:()=>n,routeModule:()=>u});var a={};i.r(a),i.d(a,{default:()=>handler});var r=i(1802),s=i(7153),d=i(6249),l=i(6962);async function handler(e,t){let i=e.headers.authorization;if(!i||!i.startsWith("Bearer "))return t.status(401).json({error:"not_authenticated"});let a=i.split(" ")[1],{data:r}=await l.R.auth.getUser(a);if(!r?.user)return t.status(401).json({error:"invalid_token"});let s=r.user.id,{data:d}=await l.R.from("votes").select("id, weight, created_at, item_id, list_id").eq("user_id",s).order("created_at",{ascending:!1}).limit(10),n=(d||[]).map(e=>e.item_id),o={};if(n.length){let{data:e}=await l.R.from("list_items").select("id,title").in("id",n);(e||[]).forEach(e=>o[e.id]=e)}let{data:u}=await l.R.from("lists").select("id,title").order("created_at",{ascending:!1}).limit(10);t.json({votes_count:(d||[]).length,lists_count:(u||[]).length,recent_votes:(d||[]).map(e=>({id:e.id,weight:e.weight,created_at:e.created_at,item_title:o[e.item_id]?.title||"..."})),my_lists:u||[]})}let n=(0,d.l)(a,"default"),o=(0,d.l)(a,"config"),u=new r.PagesAPIRouteModule({definition:{kind:s.x.PAGES_API,page:"/api/user/profile",pathname:"/api/user/profile",bundlePath:"",filename:""},userland:a})},6962:(e,t,i)=>{i.d(t,{R:()=>s});let a=require("@supabase/supabase-js"),r=process.env.SUPABASE_SERVICE_ROLE_KEY,s=(0,a.createClient)("https://pgsvorcullkrgmcbpszb.supabase.co",r,{auth:{persistSession:!1}})}};var t=require("../../../webpack-api-runtime.js");t.C(e);var __webpack_exec__=e=>t(t.s=e),i=t.X(0,[222],()=>__webpack_exec__(6144));module.exports=i})();