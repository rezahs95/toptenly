(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[277],{6896:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile",function(){return t(3108)}])},3108:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return Profile}});var n=t(5893),c=t(7294),i=t(3550);function Profile(){var e;let[s,t]=(0,c.useState)(null),[l,a]=(0,c.useState)(null);return((0,c.useEffect)(()=>{i.O.auth.getSession().then(e=>{let{data:s}=e;return t(s.session)});let{data:e}=i.O.auth.onAuthStateChange((e,s)=>t(s));return()=>e.subscription.unsubscribe()},[]),(0,c.useEffect)(()=>{(async function(){if(!(null==s?void 0:s.access_token))return;let e=await fetch("/api/user/profile",{headers:{Authorization:"Bearer ".concat(s.access_token)}});e.ok&&a(await e.json())})()},[null==s?void 0:s.access_token]),s)?l?(0,n.jsxs)("div",{className:"space-y-6",children:[(0,n.jsxs)("div",{className:"card p-6",children:[(0,n.jsxs)("h1",{className:"text-2xl font-bold mb-1",children:["سلام، ",null===(e=s.user)||void 0===e?void 0:e.email]}),(0,n.jsxs)("div",{className:"text-sm opacity-70",children:["تعداد رأی‌ها: ",l.votes_count," — تعداد لیست‌های ساخته‌شده: ",l.lists_count]})]}),(0,n.jsxs)("div",{className:"grid md:grid-cols-2 gap-6",children:[(0,n.jsxs)("div",{className:"card p-4",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"رأی‌های اخیر"}),(0,n.jsx)("ul",{className:"space-y-2",children:l.recent_votes.map(e=>(0,n.jsxs)("li",{className:"flex justify-between",children:[(0,n.jsx)("span",{children:e.item_title}),(0,n.jsxs)("span",{className:"opacity-70",children:["وزن ",e.weight]})]},e.id))})]}),(0,n.jsxs)("div",{className:"card p-4",children:[(0,n.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"لیست‌های من"}),(0,n.jsx)("ul",{className:"space-y-2",children:l.my_lists.map(e=>(0,n.jsx)("li",{children:(0,n.jsx)("a",{href:"/?q=".concat(encodeURIComponent(e.title)),children:e.title})},e.id))})]})]})]}):(0,n.jsx)("div",{className:"card p-6",children:"در حال بارگذاری..."}):(0,n.jsxs)("div",{className:"card p-6",children:[(0,n.jsx)("h1",{className:"text-xl font-bold mb-2",children:"پروفایل"}),(0,n.jsx)("p",{children:"برای دیدن پروفایل ابتدا وارد شوید."})]})}}},function(e){e.O(0,[774,888,179],function(){return e(e.s=6896)}),_N_E=e.O()}]);